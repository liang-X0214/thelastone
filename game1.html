<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‹å¨å¨˜çƒ¹é¥ª</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }
        @font-face { font-family: 'MyFont'; src: url('img/yezigongchangxiaoshitou.ttf') format('truetype'); }
        body {
            font-family: MyFont;
            background-image:url("img/chufang.png");
			background-size: cover;
            min-height: 100vh;
            padding: 10px;
            color: white;
            text-align: center;
        }
        
        .error {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 99, 99, 0.9);
            color: yellow;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            display: none;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .header {
            margin: 10px 0;
            font-size: 24px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(85, 85, 85, 0.2);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .stat-value {
            font-size: 20px;
            color: #ffe979;
            margin-top: 5px;
        }
        
        .targets {
            background: rgba(85, 85, 85, 0.2);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .target-list {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .target-emoji {
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
        }
        
        .game-area {
            width: 100%;
            height: 60vh;
            background: rgba(85, 85, 85, 0.2);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .pot {
            width: 100px;
            height: 50px;
            background: #8B4513;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 0 0 50px 50px;
        }
        
        .ingredient {
            position: absolute;
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .countdown {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: #ffe979;
            z-index: 100;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #ff7e5f, #feb47b);
            border-radius: 20px;
            padding: 25px;
            width: 80%;
			height:70%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
			overflow-y: scroll; 
        }
        
        .modal h2 {
            margin-bottom: 15px;
            color: white;
        }
        
        .modal p {
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 16px;
        }
        
        .modal button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .hidden {
            display: none;
        }
        
        .instruction {
            margin: 10px 0;
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }
        
        .fail-modal {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
        }
        
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        #continueBtn {
            background: #36D1DC;
        }
        
        #restartBtn {
            background: #4CAF50;
        }
        
        #gameOverBtn {
            background: #FF5722;
        }
        
        #mainMenuBtn {
            background: #2196F3;
        }
        
        #failMainMenuBtn {
            background: #9C27B0;
        }
        
        /* å¼€å§‹å¼¹çª—æ ·å¼ */
        #startModal .modal-content {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            max-width: 500px;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        #startModal h2 {
            color: #FFD700;
            margin-bottom: 20px;
            font-size: 28px;
        }
        
        #startModal p {
            color: white;
            margin-bottom: 10px;
        }
        
        #startModal ul li {
            color: white;
            margin-bottom: 5px;
        }
        
        #startGameBtn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="error hidden" id="error">èœé‡Œæ²¡æœ‰è¿™ä¸ªï¼</div>
    
    <!-- å¼€å§‹å¼¹çª— -->
    <div class="modal" id="startModal">
        <div class="modal-content">
            <h2>ğŸ‘©â€ğŸ³ å®‹ä»£å¨å¨˜ç®€ä»‹</h2>
            <div style="text-align: left; line-height: 1.6; margin: 20px 0;">
                <p>å®‹ä»£å¨å¨˜æ˜¯ä¸­å›½å†å²ä¸Šæœ€æ—©å‡ºç°çš„ä¸“ä¸šå¥³æ€§å¨å¸ˆç¾¤ä½“ã€‚å¥¹ä»¬æŠ€è‰ºç²¾æ¹›ã€åœ°ä½å°Šè´µï¼Œä¸ä»…æœåŠ¡äºå®«å»·è´µæ—ï¼Œä¹Ÿæ´»è·ƒäºå¸‚äº•é…’æ¥¼ã€‚</p>
                <p>ç‰¹ç‚¹ï¼š</p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>å—è¿‡ä¸“ä¸šè®­ç»ƒï¼Œçƒ¹é¥ªæŠ€æœ¯é«˜è¶…</li>
                    <li>è®²ç©¶é£Ÿææ­é…å’Œåˆ€å·¥æŠ€è‰º</li>
                    <li>å¼€åˆ›äº†è®¸å¤šç»å…¸èœå¼</li>
                    <li>æ˜¯å®‹ä»£é¥®é£Ÿæ–‡åŒ–çš„é‡è¦ä»£è¡¨</li>
                </ul>
                <p>æœ¬æ¸¸æˆä¸­ï¼Œä½ å°†æ‰®æ¼”ä¸€ä½å®‹ä»£å¨å¨˜ï¼ŒæŒ‘æˆ˜åˆ¶ä½œä¸‰é“å®‹ä»£åèœï¼</p>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 15px 0; text-align: left;">
                <p><strong>ğŸ® æ¸¸æˆæ“ä½œï¼š</strong></p>
                <p>1. æ»‘åŠ¨æ‰‹æŒ‡æ§åˆ¶é”…çš„å·¦å³ç§»åŠ¨</p>
                <p>2. æ¥ä½ä¸Šæ–¹æ‰è½çš„ç›®æ ‡é£Ÿæ</p>
                <p>3. é¿å…æ¥åˆ°éç›®æ ‡é£Ÿæï¼ˆä¼šé‡ç½®è¿›åº¦ï¼‰</p>
                <p>4. åœ¨è§„å®šæ—¶é—´å†…æ”¶é›†è¶³å¤Ÿé£Ÿæå®Œæˆèœå“</p>
                <p>5. æ¯å®Œæˆä¸€é“èœå­¦ä¹ å®‹ä»£ç¾é£ŸçŸ¥è¯†</p>
            </div>
            <div style="color: #FFD700; font-weight: bold; margin: 15px 0;">
                <p>ğŸ“ æ³¨æ„ï¼šæ¯å…³60ç§’ï¼Œå…±3å…³ï¼ŒåŠ æ²¹ï¼</p>
            </div>
            <button id="startGameBtn">å¼€å§‹çƒ¹é¥ªä¹‹æ—…</button>
        </div>
    </div>
    
    <h1 class="header">ğŸ³ å®‹å¨å¨˜çƒ¹é¥ª</h1>
    
    <div class="stats">
        <div>
            <div>å…³å¡</div>
            <div class="stat-value" id="level">1/3</div>
        </div>
        <div>
            <div>åˆ†æ•°</div>
            <div class="stat-value" id="score">0</div>
        </div>
        <div>
            <div>æ—¶é—´</div>
            <div class="stat-value" id="time">60</div>
        </div>
    </div>
    
    <div class="targets">
        <div>ç›®æ ‡é£Ÿæ</div>
        <div class="target-list" id="targets"></div>
    </div>
    
    <div class="instruction">åœ¨æ¸¸æˆåŒºåŸŸæ»‘åŠ¨æ‰‹æŒ‡ç§»åŠ¨é”…</div>
    
    <div class="game-area" id="gameArea">
        <div class="countdown hidden" id="countdown">3</div>
        <div class="pot" id="pot"></div>
    </div>
    
    <div class="modal hidden" id="knowledgeModal">
        <div class="modal-content">
            <h2>ç¾é£ŸçŸ¥è¯†</h2>
            <p id="knowledgeText"></p>
            <button id="continueBtn">ç»§ç»­æ¸¸æˆ</button>
        </div>
    </div>
    
    <div class="modal hidden" id="endMenu">
        <div class="modal-content">
            <h2>ğŸ‰ æ¸¸æˆå®Œæˆ</h2>
            <p>æœ€ç»ˆåˆ†æ•°: <span id="finalScore">0</span></p>
            <div class="button-group">
                <button id="restartBtn">é‡æ–°æ¸¸æˆ</button>
                <button id="mainMenuBtn">è¿”å›ä¸»ç•Œé¢</button>
                <button onclick="startTest()">å¼€å§‹æµ‹éªŒ</button>
            </div>
        </div>
    </div>
    
    <!-- æ–°å¢çš„æ¸¸æˆå¤±è´¥å¼¹çª— -->
    <div class="modal hidden" id="failModal">
        <div class="modal-content fail-modal">
            <h2>â° æ—¶é—´åˆ°ï¼</h2>
            <p>æ¸¸æˆç»“æŸ</p>
            <p style="font-size: 24px; color: #FFD700; margin: 15px 0;">å¾—åˆ†: <span id="failScore">0</span></p>
            <div class="button-group">
                <button id="gameOverBtn">é‡æ–°å¼€å§‹</button>
                <button id="failMainMenuBtn">è¿”å›ä¸»ç•Œé¢</button>
            </div>
        </div>
    </div>

    <script>
        // æ˜¾ç¤ºå¼€å§‹å¼¹çª—
        document.addEventListener('DOMContentLoaded', function() {
            const startModal = document.getElementById('startModal');
            const startGameBtn = document.getElementById('startGameBtn');
            
            // å¼€å§‹æ¸¸æˆæŒ‰é’®äº‹ä»¶
            startGameBtn.addEventListener('click', function() {
                startModal.classList.add('hidden');
                init();
            });
        });
        
        // é£Ÿææ•°æ®
        const ingredients = [
            { id: 1, emoji: "ğŸŸ", bgColor: "#E1F5FE" },
            { id: 2, emoji: "ğŸ„", bgColor: "#EFEBE9" },
            { id: 3, emoji: "ğŸ§ˆ", bgColor: "#FFFDE7" },
            { id: 4, emoji: "ğŸ—", bgColor: "#FFF3E0" },
            { id: 5, emoji: "ğŸ¥•", bgColor: "#FBE9E7" },
            { id: 6, emoji: "ğŸ¥š", bgColor: "#FFFDE7" },
            { id: 7, emoji: "ğŸŒ°", bgColor: "#EFEBE9" },
            { id: 8, emoji: "ğŸ", bgColor: "#F1F8E9" },
            { id: 9, emoji: "ğŸŒ¾", bgColor: "#FFFDE7" }
        ];
        
        // å…³å¡é…ç½®
        const levels = [
            { targets: [1, 2, 3], required: 3, knowledge: "å®‹å«‚é±¼ç¾¹ï¼šç›¸ä¼ ç”±å—å®‹å¨å¨˜å®‹å«‚åˆ›åˆ¶ã€‚ä¸»è¦åŸæ–™æœ‰æ–°é²œé²«é±¼ã€ç”Ÿå§œã€è‘±ã€æ–™é…’ã€ç›ã€æµ“ç¨ çš„é±¼éª¨æ±¤ï¼Œè¿˜ä¼šåŠ å…¥è±†è…ã€è˜‘è‡ç­‰é…èœã€‚" },
            { targets: [4, 5, 6], required: 3, knowledge: "æ°´æ™¶è„ï¼šæ˜¯ä¸€ç§æ™¶è¹é€äº®çš„è‚‰å†»ã€‚ä¸»æ–™æœ‰çŒªè‚‰çš®ã€é¸¡è‚‰ã€çŒªè‚˜ï¼Œè¾…æ–™åŒ…æ‹¬ç«è…¿ã€é¦™èœã€é¸¡è›‹é»„ç³•ã€èƒ¡èåœç­‰ï¼Œè°ƒæ–™æœ‰é»„é…’ã€ç›ã€å‘³ç²¾ã€è‘±æ±ã€å§œæ±ç­‰ã€‚" },
            { targets: [7, 8, 9], required: 3, knowledge: "èƒœè‚‰ï¼šç´ é¦…å„¿ç‚¹å¿ƒï¼Œç”¨è˜‘è‡ã€é²œç¬‹ã€æ ¸æ¡ƒä»ã€æ¾ä»ã€é¢çš®ç­‰ä¸ºåŸæ–™ï¼Œç…çƒ™è€Œæˆã€‚" }
        ];
        
        // æ¸¸æˆçŠ¶æ€
        let game = {
            level: 0,
            score: 0,
            time: 60,
            playing: false,
            collected: {},
            ingredients: [],
            potX: 50
        };
        
        // DOMå…ƒç´ 
        const el = {
            error: document.getElementById('error'),
            level: document.getElementById('level'),
            score: document.getElementById('score'),
            time: document.getElementById('time'),
            targets: document.getElementById('targets'),
            gameArea: document.getElementById('gameArea'),
            pot: document.getElementById('pot'),
            countdown: document.getElementById('countdown'),
            knowledgeModal: document.getElementById('knowledgeModal'),
            knowledgeText: document.getElementById('knowledgeText'),
            continueBtn: document.getElementById('continueBtn'),
            endMenu: document.getElementById('endMenu'),
            finalScore: document.getElementById('finalScore'),
            restartBtn: document.getElementById('restartBtn'),
            mainMenuBtn: document.getElementById('mainMenuBtn'),
            failModal: document.getElementById('failModal'),
            failScore: document.getElementById('failScore'),
            gameOverBtn: document.getElementById('gameOverBtn'),
            failMainMenuBtn: document.getElementById('failMainMenuBtn'),
            startModal: document.getElementById('startModal')
        };
        
        // === æ–°å¢ï¼šè¿”å›ä¸»é¡µé¢çš„å‡½æ•° ===
        function goBackToMain() {
            // æ£€æŸ¥æ˜¯å¦åœ¨ iframe ä¸­è¿è¡Œ
            if (window.parent && window.parent.closeGame) {
                // è°ƒç”¨çˆ¶é¡µé¢çš„å…³é—­å‡½æ•°
                window.parent.closeGame();
            } else {
                // å¦‚æœæ²¡æœ‰çˆ¶é¡µé¢å‡½æ•°ï¼Œå›é€€åˆ°åŸæ¥çš„è·³è½¬æ–¹å¼
                window.location.href = 'index.html';
            }
        }
        
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError() {
            el.error.style.display = 'block';
            setTimeout(() => {
                el.error.style.display = 'none';
            }, 1000);
        }
        
        // è¿”å›ä¸»ç•Œé¢
        function returnToMainMenu() {
            // === ä¿®æ”¹ï¼šä½¿ç”¨æ–°çš„è¿”å›å‡½æ•° ===
            goBackToMain();
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function init() {
            // ç¡®ä¿å¼€å§‹å¼¹çª—æ˜¯éšè—çš„
            if (el.startModal && !el.startModal.classList.contains('hidden')) {
                el.startModal.classList.add('hidden');
            }
            
            game.level = 0;
            game.score = 0;
            game.playing = false;
            game.ingredients.forEach(ing => ing.element.remove());
            game.ingredients = [];
            el.failModal.classList.add('hidden');
            el.endMenu.classList.add('hidden');
            nextLevel();
        }
        
        // ä¸‹ä¸€å…³
        function nextLevel() {
            game.level++;
            if (game.level > levels.length) {
                endGame();
                return;
            }
            
            el.knowledgeModal.classList.add('hidden');
            const level = levels[game.level - 1];
            game.time = 60;
            game.collected = {};
            
            level.targets.forEach(id => game.collected[id] = 0);
            
            el.level.textContent = `${game.level}/3`;
            el.score.textContent = game.score;
            el.time.textContent = game.time;
            
            showTargets();
            startCountdown();
        }
        
        // æ˜¾ç¤ºç›®æ ‡é£Ÿæ
        function showTargets() {
            const level = levels[game.level - 1];
            el.targets.innerHTML = '';
            
            level.targets.forEach(id => {
                const ing = ingredients.find(i => i.id === id);
                const item = document.createElement('div');
                item.innerHTML = `
                    <div class="target-emoji" style="background:${ing.bgColor}">
                        ${ing.emoji}
                    </div>
                    <div style="font-size:12px;color:#FFD700">0/${level.required}</div>
                `;
                item.dataset.id = id;
                el.targets.appendChild(item);
            });
        }
        
        // å¼€å§‹å€’è®¡æ—¶
        function startCountdown() {
            el.countdown.classList.remove('hidden');
            let count = 3;
            el.countdown.textContent = count;
            
            const timer = setInterval(() => {
                count--;
                el.countdown.textContent = count;
                if (count <= 0) {
                    clearInterval(timer);
                    el.countdown.classList.add('hidden');
                    startGame();
                }
            }, 1000);
        }
        
        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            game.playing = true;
            
            // è®¡æ—¶å™¨
            const timeTimer = setInterval(() => {
                if (!game.playing) {
                    clearInterval(timeTimer);
                    return;
                }
                game.time--;
                el.time.textContent = game.time;
                if (game.time <= 0) {
                    clearInterval(timeTimer);
                    gameOver();
                }
            }, 1000);
            
            // ç”Ÿæˆé£Ÿæ
            const ingredientTimer = setInterval(() => {
                if (!game.playing) {
                    clearInterval(ingredientTimer);
                    return;
                }
                const ing = ingredients[Math.floor(Math.random() * ingredients.length)];
                const element = document.createElement('div');
                element.className = 'ingredient';
                element.textContent = ing.emoji;
                element.style.background = ing.bgColor;
                element.style.left = `${Math.random() * 90 + 5}%`;
                element.style.top = '-50px';
                
                el.gameArea.appendChild(element);
                
                game.ingredients.push({
                    element,
                    id: ing.id,
                    y: -50,
                    speed: 1 + Math.random() * 1
                });
            }, 800);
            
            // æ¸¸æˆå¾ªç¯
            function gameLoop() {
                if (!game.playing) return;
                
                el.pot.style.left = `${game.potX}%`;
                
                game.ingredients.forEach((ing, i) => {
                    ing.y += ing.speed;
                    ing.element.style.top = `${ing.y}px`;
                    
                    // ç¢°æ’æ£€æµ‹
                    const potRect = el.pot.getBoundingClientRect();
                    const ingRect = ing.element.getBoundingClientRect();
                    const isCollision = !(ingRect.bottom < potRect.top ||
                                        ingRect.top > potRect.bottom ||
                                        ingRect.right < potRect.left ||
                                        ingRect.left > potRect.right);
                    
                    if (isCollision) {
                        catchIngredient(ing, i);
                    } else if (ing.y > el.gameArea.clientHeight) {
                        ing.element.remove();
                        game.ingredients.splice(i, 1);
                    }
                });
                
                requestAnimationFrame(gameLoop);
            }
            
            gameLoop();
        }
        
        // æ¥ä½é£Ÿæ
        function catchIngredient(ing, index) {
            ing.element.remove();
            game.ingredients.splice(index, 1);
            
            const isTarget = levels[game.level - 1].targets.includes(ing.id);
            
            if (isTarget) {
                // æ­£ç¡®é£Ÿæ
                game.collected[ing.id]++;
                game.score += 10;
                el.score.textContent = game.score;
                
                // æ›´æ–°ç›®æ ‡è®¡æ•°
                const targetItem = document.querySelector(`[data-id="${ing.id}"] div:last-child`);
                targetItem.textContent = `${game.collected[ing.id]}/${levels[game.level - 1].required}`;
                targetItem.style.color = '#4CAF50';
                
                // æ£€æŸ¥å…³å¡å®Œæˆ
                const allCollected = levels[game.level - 1].targets.every(id => 
                    game.collected[id] >= levels[game.level - 1].required
                );
                if (allCollected) {
                    setTimeout(() => {
                        levelComplete();
                    }, 300);
                }
            } else {
                // é”™è¯¯é£Ÿæ - æ˜¾ç¤ºé”™è¯¯æç¤ºå¹¶é‡ç½®è¿›åº¦
                showError();
                levels[game.level - 1].targets.forEach(id => {
                    game.collected[id] = 0;
                    const item = document.querySelector(`[data-id="${id}"] div:last-child`);
                    item.textContent = `0/${levels[game.level - 1].required}`;
                    item.style.color = '#FFD700';
                });
            }
        }
        
        // å…³å¡å®Œæˆ
        function levelComplete() {
            game.playing = false;
            game.ingredients.forEach(ing => ing.element.remove());
            game.ingredients = [];
            
            el.knowledgeText.textContent = levels[game.level - 1].knowledge;
            el.knowledgeModal.classList.remove('hidden');
        }
        
        // æ¸¸æˆå¤±è´¥ï¼ˆæ—¶é—´åˆ°ï¼‰
        function gameOver() {
            game.playing = false;
            game.ingredients.forEach(ing => ing.element.remove());
            game.ingredients = [];
            
            el.failScore.textContent = game.score;
            setTimeout(() => {
                el.failModal.classList.remove('hidden');
            }, 500);
        }
        
        // æ¸¸æˆç»“æŸï¼ˆå®Œæˆæ‰€æœ‰å…³å¡ï¼‰
        function endGame() {
            game.playing = false;
            game.ingredients.forEach(ing => ing.element.remove());
            game.ingredients = [];
            
            el.finalScore.textContent = game.score;
            setTimeout(() => {
                el.endMenu.classList.remove('hidden');
            }, 500);
        }
        
        // é‡æ–°æ¸¸æˆ
        function restartGame() {
            el.endMenu.classList.add('hidden');
            init();
        }
        
        // å¼€å§‹æµ‹éªŒ
        function startTest() {
            
            // è·³è½¬åˆ°ç­”é¢˜æ¸¸æˆ
            if (window.parent && window.parent.startQuizGame) {
                window.parent.startQuizGame();
            } else {
                // å‡è®¾ç­”é¢˜æ¸¸æˆä¸»æ–‡ä»¶ä¸º quiz-main.htmlï¼Œç­”é¢˜1ç•Œé¢ä¸º quiz-question1.html
                window.location.href = 'question2.html?from=puzzle';
            }
        }
        
        // äº‹ä»¶ç›‘å¬
        el.continueBtn.addEventListener('click', () => {
            nextLevel();
        });
        
        el.restartBtn.addEventListener('click', restartGame);
        
        // === ä¿®æ”¹ï¼šè¿”å›ä¸»ç•Œé¢æŒ‰é’®ï¼ˆå®Œæˆç•Œé¢ï¼‰===
        el.mainMenuBtn.addEventListener('click', function() {
            // ä½¿ç”¨æ–°çš„è¿”å›å‡½æ•°
            goBackToMain();
        });
        
        el.gameOverBtn.addEventListener('click', () => {
            el.failModal.classList.add('hidden');
            init();
        });
        
        // === ä¿®æ”¹ï¼šè¿”å›ä¸»ç•Œé¢æŒ‰é’®ï¼ˆå¤±è´¥ç•Œé¢ï¼‰===
        el.failMainMenuBtn.addEventListener('click', function() {
            // ä½¿ç”¨æ–°çš„è¿”å›å‡½æ•°
            goBackToMain();
        });
        
        // æ»‘åŠ¨æ§åˆ¶é”…çš„ç§»åŠ¨
        el.gameArea.addEventListener('touchstart', (e) => {
            if (!game.playing) return;
            const rect = el.gameArea.getBoundingClientRect();
            const x = e.touches[0].clientX - rect.left;
            game.potX = Math.max(5, Math.min(95, (x / rect.width) * 100));
        });
        
        el.gameArea.addEventListener('touchmove', (e) => {
            if (!game.playing) return;
            const rect = el.gameArea.getBoundingClientRect();
            const x = e.touches[0].clientX - rect.left;
            game.potX = Math.max(5, Math.min(95, (x / rect.width) * 100));
            e.preventDefault();
        });
        
        // é˜²æ­¢é¡µé¢æ»šåŠ¨
        document.addEventListener('touchmove', (e) => {
            if (e.target.closest('.game-area')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>